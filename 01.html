<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>盛世汉风：大汉帝国</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      /* --- 字體導入 --- */
      @import url('https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Serif+TC:wght@400;700;900&family=ZCOOL+XiaoWei&family=Zhi+Mang+Xing&display=swap');
      
      /* --- 變數定義 (漢代風格) --- */
      :root {
        --bg-color: #F8F6F2; /* 宣紙米白 */
        --primary-color: #42675A; /* 主色 - 漢青 */
        --accent-color: #893F27;  /* 強調色 - 赤磚 */
        --accent-light: #E0D8CC;  /* 強調淺色 - 淡米 */
        --text-color: #3D3D3D;    /* 內文顏色 - 深灰黑 */
        --title-font: 'Ma Shan Zheng', 'Noto Serif TC', serif;
        --body-font: 'Noto Serif TC', serif;
        --cursive-font: 'Zhi Mang Xing', cursive;
        --elegant-font: 'ZCOOL XiaoWei', serif;
      }

      html { scroll-behavior: smooth; }
      body {
        margin: 0;
        padding: 0;
        background-color: var(--bg-color);
        color: var(--text-color);
        font-family: var(--body-font);
        font-size: 18px;
        background-image: url('https://www.transparenttextures.com/patterns/paper.png'); /* 書卷紋理 */
        overflow-x: hidden;
      }
      
      /* --- 水墨卷轴效果 --- */
      .silk-scroll-effect {
        position: relative;
      }
      .silk-scroll-effect::before,
      .silk-scroll-effect::after {
        content: '';
        position: absolute;
        width: 60px;
        height: 100%;
        top: 0;
        z-index: 5;
        background: linear-gradient(90deg, rgba(248, 246, 242, 0.8), transparent);
        pointer-events: none;
      }
      .silk-scroll-effect::before {
        left: 0;
      }
      .silk-scroll-effect::after {
        right: 0;
        transform: rotate(180deg);
      }
      
      /* --- 通用區塊設定 --- */
      .slide-section {
        width: 100%;
        min-height: 100vh;
        padding: 180px 40px 80px; 
        position: relative;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        max-width: 1600px;
        margin: 0 auto;
        border-bottom: 1px solid rgba(66, 103, 90, 0.1);
      }
      
      /* --- 内容承载层 --- */
      .content-container {
        background: rgba(248, 246, 242, 0.92);
        border-radius: 12px;
        padding: 40px;
        box-shadow: 0 15px 50px rgba(0, 0, 0, 0.15);
        border: 1px solid rgba(137, 63, 39, 0.3);
        position: relative;
        z-index: 10;
        width: 90%;
        max-width: 1400px;
        margin: 0 auto;
      }
      .content-container::before {
        content: '';
        position: absolute;
        top: 10px;
        left: 10px;
        right: 10px;
        bottom: 10px;
        border: 2px solid rgba(137, 63, 39, 0.15);
        border-radius: 8px;
        pointer-events: none;
        z-index: -1;
      }

      /* --- 標題美化 --- */
      .section-title {
        font-family: var(--title-font);
        font-size: 4.5rem;
        color: var(--primary-color);
        margin-bottom: 50px;
        text-align: center;
        line-height: 1.2;
        position: relative;
        padding-bottom: 30px;
        text-shadow: 3px 3px 6px rgba(0,0,0,0.1);
        letter-spacing: 2px;
      }
      /* 标题装饰线 (水墨筆觸) */
      .section-title::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 200px;
        height: 10px;
        background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="10" viewBox="0 0 200 10"><path d="M0,5 C40,2 80,8 120,5 S160,2 200,6" fill="none" stroke="%23893F27" stroke-width="3" stroke-linecap="round"/></svg>');
        background-repeat: no-repeat;
        background-position: center;
      }

      /* --- 導覽列 --- */
      .navbar {
        position: fixed; top: 0; left: 0; width: 100%;
        background-color: rgba(66, 103, 90, 0.95); /* 漢青 */
        backdrop-filter: blur(10px);
        box-shadow: 0 4px 20px rgba(0,0,0,0.4);
        z-index: 1000; padding: 15px 20px;
        transition: all 0.4s ease;
      }
      .navbar.scrolled {
        padding: 10px 20px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.3);
      }
      .nav-links { display: flex; justify-content: center; flex-wrap: wrap; gap: 10px 25px; }
      .nav-links a {
        color: var(--bg-color); 
        font-family: var(--elegant-font);
        font-size: 18px; 
        padding: 10px 20px; 
        border-radius: 30px;
        transition: all 0.4s ease;
        position: relative;
        letter-spacing: 1px;
      }
      .nav-links a:hover, .nav-links a.active { 
        background: linear-gradient(135deg, var(--accent-color), #6E2D1C);
        color: var(--primary-color);
        transform: translateY(-4px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      }
      .nav-links a::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border-radius: 30px;
        background: linear-gradient(135deg, transparent, rgba(137, 63, 39, 0.3));
        opacity: 0;
        transition: opacity 0.3s ease;
      }
      .nav-links a:hover::before {
        opacity: 1;
      }

      /* --- 控制面板 --- */
      .control-panel {
        position: fixed; top: 120px; right: 30px;
        display: flex; flex-direction: column; gap: 15px; z-index: 999;
      }
      .control-btn {
        width: 55px; height: 55px;
        background: linear-gradient(135deg, var(--primary-color), #345448);
        color: var(--accent-color);
        border: 2px solid var(--accent-color);
        border-radius: 50%;
        display: flex; justify-content: center; align-items: center;
        cursor: pointer; font-size: 22px;
        transition: all 0.4s ease;
        box-shadow: 0 5px 15px rgba(0,0,0,0.25);
      }
      .control-btn:hover {
        background: linear-gradient(135deg, var(--accent-color), #6E2D1C);
        color: var(--primary-color);
        transform: scale(1.15) rotate(12deg);
        box-shadow: 0 8px 20px rgba(0,0,0,0.4);
      }
      #to-top-btn { display: none; }
      
      /* --- 語音導讀按鈕 Playing 狀態 --- */
      .tts-btn.is-playing {
        background-color: var(--accent-color);
        color: var(--primary-color);
      }
      .tts-btn.is-playing:hover {
        background-color: #6E2D1C;
      }
      
      /* --- 自動播放時隱藏語音按鈕 --- */
      .autoplay-active .tts-btn {
        display: none;
      }
      
      /* --- 語音播放時鎖定畫面樣式 --- */
      body.tts-active .nav-links a,
      body.tts-active #to-top-btn {
          pointer-events: none;
          opacity: 0.5;
          cursor: not-allowed;
          transition: opacity 0.3s ease;
      }

      /* --- 捲動動畫 --- */
      .scroll-reveal { 
        opacity: 0; 
        transform: translateY(50px); 
        transition: opacity 1s ease-out, transform 1s ease-out; 
      }
      .scroll-reveal.visible { 
        opacity: 1; 
        transform: translateY(0); 
      }
      
      /* --- 時間軸視覺強化 --- */
      .visual-timeline { 
        position: relative; 
        width: 100%; 
        max-width: 900px; 
        margin: 50px auto;
        padding: 20px 0;
      }
      .visual-timeline::after {
        content: ''; 
        position: absolute; 
        width: 8px; 
        background: linear-gradient(to bottom, transparent, var(--accent-color), transparent);
        top: 0; 
        bottom: 0; 
        left: 50%; 
        margin-left: -4px; 
        z-index: 1;
        border-radius: 10px;
        box-shadow: 0 0 15px rgba(137, 63, 39, 0.5);
      }
      .timeline-container { 
        padding: 10px 40px; 
        position: relative; 
        background-color: inherit; 
        width: 50%; 
      }
      .timeline-container.left { left: 0; }
      .timeline-container.right { left: 50%; }
      .timeline-container::after {
        content: ''; 
        position: absolute; 
        width: 35px; 
        height: 35px; 
        right: -17px;
        background-color: var(--bg-color); 
        border: 4px solid var(--primary-color);
        top: 25px; 
        border-radius: 50%; 
        z-index: 2;
        transition: all 0.4s ease;
        box-shadow: 0 0 0 6px rgba(137, 63, 39, 0.4);
      }
      .timeline-container:hover::after { 
        transform: scale(1.4);
        background-color: var(--accent-color);
        box-shadow: 0 0 0 8px rgba(137, 63, 39, 0.6);
      }
      .timeline-container.right::after { left: -17px; }
      .timeline-content {
        padding: 30px 40px; 
        background: linear-gradient(145deg, rgba(255, 255, 255, 0.95), rgba(224, 216, 204, 0.4)); 
        position: relative; 
        border-radius: 15px; 
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        border: 1px solid rgba(66, 103, 90, 0.2);
        border-left: 10px solid var(--primary-color);
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        backdrop-filter: blur(4px);
      }
      .timeline-content:hover {
        transform: translateY(-15px) rotate(1deg);
        box-shadow: 0 15px 35px rgba(0,0,0,0.3);
      }
      .timeline-content h3 { 
        font-size: 26px; 
        color: var(--primary-color); 
        font-family: var(--title-font); 
        margin-bottom: 15px;
        border-bottom: 2px solid var(--accent-light);
        padding-bottom: 10px;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
      }
      .timeline-content p { 
        font-size: 18px; 
        line-height: 1.8; 
        font-family: var(--elegant-font);
      }

      /* --- 互動地圖 --- */
      .map-container-interactive { 
        position: relative; 
        width: 100%; 
        max-width: 800px; 
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        border: 3px solid var(--accent-light);
        transform: perspective(1000px) rotateX(5deg) rotateY(0deg);
        transition: transform 0.5s ease;
      }
      .map-container-interactive:hover {
        transform: perspective(1000px) rotateX(2deg) rotateY(2deg);
      }
      .hotspot {
        position: absolute; 
        width: 40px; 
        height: 40px;
        background: radial-gradient(circle, rgba(137, 63, 39, 0.9), rgba(110, 45, 28, 0.9)); 
        border: 3px solid white;
        border-radius: 50%; 
        cursor: pointer;
        transition: all 0.4s ease;
        display: flex; 
        justify-content: center; 
        align-items: center;
        box-shadow: 0 0 20px rgba(137, 63, 39, 0.8);
        animation: pulse 2s infinite;
        z-index: 10;
      }
      @keyframes pulse { 
        0% { transform: scale(1); box-shadow: 0 0 10px rgba(137, 63, 39, 0.5); } 
        50% { transform: scale(1.2); box-shadow: 0 0 30px rgba(137, 63, 39, 1); } 
        100% { transform: scale(1); box-shadow: 0 0 10px rgba(137, 63, 39, 0.5); } 
      }
      .hotspot:hover { 
        transform: scale(1.6); 
        background: radial-gradient(circle, var(--primary-color), #345448); 
        animation-play-state: paused; 
        z-index: 20;
      }
      .hotspot .fa-star { 
        color: white; 
        font-size: 18px; 
        transition: transform 0.3s ease;
      }
      .hotspot:hover .fa-star {
        transform: rotate(360deg);
      }
      .info-box {
        display: none; 
        position: absolute; 
        background: linear-gradient(135deg, rgba(20, 30, 20, 0.95), rgba(30, 45, 35, 0.95));
        color: var(--accent-light);
        padding: 25px; 
        border-radius: 12px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.6); 
        z-index: 20;
        width: 300px; 
        border-left: 5px solid var(--accent-color);
        font-family: var(--elegant-font);
        backdrop-filter: blur(8px);
        animation: fadeIn 0.4s ease;
      }
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(15px); }
        to { opacity: 1; transform: translateY(0); }
      }
      .info-box h3 { 
        font-family: var(--title-font); 
        font-size: 24px; 
        color: var(--accent-color); 
        margin-bottom: 15px;
        border-bottom: 1px solid rgba(137, 63, 39, 0.4);
        padding-bottom: 10px;
      }
      .info-box p {
        font-size: 17px;
        line-height: 1.7;
      }

      /* --- 卡片通用樣式 --- */
      .styled-card {
        background: linear-gradient(145deg, rgba(255, 255, 255, 0.95), rgba(224, 216, 204, 0.3));
        border: 1px solid rgba(137, 63, 39, 0.3);
        border-radius: 18px;
        padding: 30px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.12);
        transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        height: 100%;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        position: relative;
        backdrop-filter: blur(4px);
      }
      .styled-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 6px;
        background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
      }
      .styled-card:hover {
        transform: translateY(-20px) rotate(2deg);
        box-shadow: 0 20px 40px rgba(0,0,0,0.2);
      }
      
      /* --- 圖片容器 --- */
      .image-container-styled {
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        border: 6px solid var(--accent-color);
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100%;
        transition: all 0.5s ease;
        transform: perspective(1000px) rotateX(5deg);
      }
      .image-container-styled:hover {
        box-shadow: 0 20px 50px rgba(0,0,0,0.4);
        transform: perspective(1000px) rotateX(2deg);
      }
      .image-container-styled img {
        width: auto; 
        height: auto;
        max-width: 100%; 
        max-height: 100%;
        object-fit: cover;
        transition: transform 0.5s ease;
      }
      .image-container-styled:hover img {
        transform: scale(1.1);
      }

      /* --- 首頁特殊樣式 --- */
      #title {
        position: relative;
        overflow: hidden;
        padding: 0;
      }
      #title .video-container {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 0;
      }
      #title .video-container video {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      #title .video-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(rgba(20, 30, 20, 0.45), rgba(20, 30, 20, 0.45));
        z-index: 1;
      }
      #title .border-pattern {
        position: absolute; top: 0; left: 0; right: 0; bottom: 0;
        border: 40px solid transparent;
        border-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 80 80"><path d="M0,0 L80,0 L80,80 L0,80 Z" fill="none" stroke="%23893F27" stroke-width="3"/><path d="M20,20 L60,20 L60,60 L20,60 Z" fill="none" stroke="%23893F27" stroke-width="2" stroke-dasharray="8,8"/></svg>') 40 stretch;
        pointer-events: none; z-index: 10;
      }
      #title h1 {
        font-family: 'Ma Shan Zheng', cursive;
        font-size: 8rem;
        font-weight: 700;
        margin-bottom: 25px;
        color: #F8F4E0; /* 亮米色 */
        text-shadow: 5px 5px 15px rgba(0, 0, 0, 0.9);
        letter-spacing: 3px;
        line-height: 1.1;
      }
      #title h2 {
        font-family: var(--elegant-font);
        font-size: 3rem;
        font-weight: 400;
        margin-bottom: 50px;
        color: var(--accent-color);
        letter-spacing: 3px;
        text-shadow: 3px 3px 6px rgba(0,0,0,0.7);
      }
      .copyright-notice {
        position: absolute; bottom: 25px; left: 30px;
        transform: none; font-size: 16px;
        color: var(--accent-color);
        background-color: rgba(0, 0, 0, 0.5);
        padding: 10px 22px; 
        border-radius: 12px; 
        z-index: 30;
        font-family: var(--elegant-font);
        letter-spacing: 1px;
      }
      .title-content {
        position: relative;
        z-index: 20;
        text-align: center;
        padding: 60px;
        max-width: 1400px;
        margin: 0 auto;
      }
      .title-subtitle {
        font-size: 2rem;
        margin-top: 70px;
        font-family: var(--cursive-font);
        letter-spacing: 2px;
        text-shadow: 3px 3px 8px rgba(0,0,0,0.8);
        line-height: 1.7;
        max-width: 900px;
        margin: 70px auto 0;
      }

      /* --- Section Backgrounds & Readability --- */
      .slide-section {
        background-size: cover;
        background-position: center center;
        background-attachment: fixed;
      }
      #overview { background: linear-gradient(rgba(20, 30, 20, 0.3), rgba(20, 30, 20, 0.3)), url('https://lw.news.cn/1310718851_16841331581671n.jpg') center center/cover; }
      #timeline { background: linear-gradient(rgba(20, 30, 20, 0.25), rgba(20, 30, 20, 0.25)), url('https://www.taiwanviptravel.com/wp-content/uploads/2025/04/%E9%92%9F%E6%A5%BC1-1.jpg') center center/cover; }
      #territory { background: linear-gradient(rgba(20, 30, 20, 0.25), rgba(20, 30, 20, 0.25)), url('https://cimg.cnyes.cool/prod/news/443712/o/584be3a0654c22d9d1faf6f1b51dec77.jpg') center center/cover; }
      #emperors { background: linear-gradient(rgba(20, 30, 20, 0.25), rgba(20, 30, 20, 0.25)), url('https://image.digitalarchives.tw/ImageCache/00/0f/15/87.jpg') center center/cover; }
      #government { background: linear-gradient(rgba(20, 30, 20, 0.3), rgba(20, 30, 20, 0.3)), url('https://img.soundofhope.org/2021-04/1618296067798.jpg') center center/cover; }
      #culture { background: linear-gradient(rgba(20, 30, 20, 0.3), rgba(20, 30, 20, 0.3)), url('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTFkzt_PkWle2K4SXio2KDSyvptIOq7fdC1eg&s') center center/cover; }
      #exchange { background: linear-gradient(rgba(20, 30, 20, 0.25), rgba(20, 30, 20, 0.25)), url('https://p9.itc.cn/q_70/images03/20220827/89cd642d3c304d618f858dc334fdbff2.jpeg') center center/cover; }
      #scholars { background: linear-gradient(rgba(20, 30, 20, 0.3), rgba(20, 30, 20, 0.3)), url('https://img.soundofhope.org/2022-06/d9dea81d67c65e448b69-1655915264440.jpg') center center/cover; }
      #decline { background: linear-gradient(rgba(20, 5, 0, 0.25), rgba(20, 5, 0, 0.25)), url('https://big5.cctv.com/gate/big5/culture-travel.cctv.cn//p5.img.cntv.cn/photoworkspace/contentimg/2024/10/21/2024102111453065395.jpg') center center/cover; }
      #legacy { background: linear-gradient(rgba(20, 30, 20, 0.25), rgba(20, 30, 20, 0.25)), url('https://bpic.wotucdn.com//original/35/75/26/35752694-3f7ba031e0db2a7cb6f73ba57d4b6657.jpeg!waterh470') center center/cover; }
      #han-beauty-video { background: linear-gradient(rgba(20, 30, 20, 0.25), rgba(20, 30, 20, 0.25)), url('https://bpic.wotucdn.com//original/35/75/26/35752694-3f7ba031e0db2a7cb6f73ba57d4b6657.jpeg!waterh470') center center/cover; }

      /* 保護卡片內的文字顏色，使其保持深色 */
      .timeline-content, .styled-card, .info-card, .quote-block, .h-96, .h-80 {
          text-shadow: none;
      }
      .timeline-content *, .styled-card *, .info-card *, .quote-block *, .h-96 *, .h-80 * {
          text-shadow: none;
      }
      .timeline-content, .styled-card {
        color: var(--text-color);
      }
      .timeline-content h3, .styled-card .text-green-800, .info-card .text-green-800 { 
        color: var(--primary-color); 
      }
      .styled-card .text-gray-600 { color: #4b5563; }
      .styled-card .text-gray-700 { color: #374151; }
      
      /* 針對特定元素的精細調整 */
      .info-card {
        background: linear-gradient(145deg, rgba(248, 246, 242, 0.95), rgba(224, 216, 204, 0.4)) !important;
        backdrop-filter: blur(5px);
        color: var(--text-color);
        border-radius: 15px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.12);
        padding: 30px;
      }
      .info-card li {
        color: var(--text-color);
      }
      .info-card .text-yellow-600 {
        color: #8a7c6a; /* 調整為主題色 */
      }
      .info-card .text-green-800 {
        color: var(--primary-color);
      }
      
      /* 確保圖片說明等小字使用深色 */
      #overview .text-sm, #territory .text-sm, #emperors .text-sm, #exchange .text-sm, #decline .text-sm {
        color: var(--text-color);
        opacity: 0.85;
      }
      
      /* 引言區塊文字顏色 (此處維持淺色，因為背景是暗色) */
      .quote-block {
        background: linear-gradient(135deg, rgba(20, 30, 20, 0.7), rgba(30, 45, 35, 0.7));
        border-color: var(--accent-color);
        border-left: 10px solid var(--accent-color);
        padding: 35px;
        border-radius: 15px;
        max-width: 900px;
        margin: 50px auto;
        backdrop-filter: blur(5px);
      }
      .quote-block p {
        color: var(--accent-light);
        text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
      }
      
      /* 新增元素：漢代風格装饰 (青龍) */
      .tang-decoration {
        position: absolute;
        width: 150px;
        height: 150px;
        opacity: 0.15;
        z-index: 1;
        background-size: contain;
        background-repeat: no-repeat;
      }
      .decoration-1 {
        top: 30px; left: 30px;
        background-image: url('https://png.pngtree.com/png-vector/20230303/ourmid/pngtree-chinese-style-ink-dragon-png-image_6628943.png');
      }
      .decoration-2 {
        bottom: 30px; right: 30px; transform: rotate(180deg);
        background-image: url('https://png.pngtree.com/png-vector/20230303/ourmid/pngtree-chinese-style-ink-dragon-png-image_6628943.png');
      }
      .decoration-3 {
        top: 40%; right: 5%; width: 120px; height: 120px;
        background-image: url('https://png.pngtree.com/png-vector/20230303/ourmid/pngtree-chinese-style-ink-dragon-png-image_6628943.png');
        opacity: 0.1; transform: rotate(25deg);
      }
      .decoration-4 {
        bottom: 30%; left: 5%; width: 100px; height: 100px;
        background-image: url('https://png.pngtree.com/png-vector/20230303/ourmid/pngtree-chinese-style-ink-dragon-png-image_6628943.png');
        opacity: 0.1; transform: rotate(-15deg);
      }
      
      /* 士人卡片特殊样式 */
      .scholar-card {
        background: linear-gradient(145deg, rgba(255, 255, 255, 0.95), rgba(224, 216, 204, 0.3));
        border-radius: 20px;
        overflow: hidden;
        transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        box-shadow: 0 12px 30px rgba(0,0,0,0.15);
        position: relative;
        height: 100%;
      }
      .scholar-card:hover {
        transform: translateY(-15px) rotate(1.5deg);
        box-shadow: 0 20px 45px rgba(0,0,0,0.25);
      }
      .scholar-img {
        height: 280px;
        overflow: hidden;
        position: relative;
      }
      .scholar-img img {
        width: 100%; height: 100%;
        object-fit: cover; object-position: top;
        transition: transform 0.6s ease;
      }
      .scholar-card:hover .scholar-img img {
        transform: scale(1.15);
      }
      .scholar-content { padding: 25px; }
      .scholar-name {
        font-family: var(--title-font);
        font-size: 28px;
        color: var(--primary-color);
        margin-bottom: 10px;
        border-bottom: 2px solid var(--accent-light);
        padding-bottom: 8px;
      }
      .scholar-desc {
        font-family: var(--elegant-font);
        font-size: 17px;
        line-height: 1.8;
        color: var(--text-color);
      }
      
      /* 响应式调整 */
      @media (max-width: 1024px) {
        .section-title { font-size: 3.8rem; }
        .nav-links { gap: 8px 15px; }
        .nav-links a { padding: 8px 14px; font-size: 16px; }
      }
      
      @media (max-width: 768px) {
        .section-title { font-size: 3.2rem; padding: 0 20px 20px; }
        .slide-section { padding: 180px 25px 60px; }
        #title h1 { font-size: 6rem; }
        #title h2 { font-size: 2.5rem; }
        .title-subtitle { font-size: 1.8rem; }
        .content-container { padding: 30px; }
        .timeline-container { width: 100%; padding: 10px 30px 10px 60px; left: 0 !important; }
        .timeline-container::after { left: 25px !important; right: auto !important; }
        .visual-timeline::after { left: 30px; }
        .control-panel { top: auto; bottom: 20px; right: 15px; }
        .control-btn { width: 48px; height: 48px; font-size: 20px; }
        #title .video-container video {
          object-position: 70% center;
        }
      }
      
      @media (max-width: 480px) {
        .section-title { font-size: 2.8rem; }
        #title h1 { font-size: 4.5rem; }
        #title h2 { font-size: 2rem; }
        .title-subtitle { font-size: 1.5rem; margin-top: 50px; }
        .copyright-notice { font-size: 14px; left: 15px; bottom: 15px; }
        .nav-links a { padding: 7px 12px; font-size: 15px; }
        .content-container { padding: 20px; }
      }
    </style>
</head>
<body class="silk-scroll-effect">

    <!-- 背景音樂播放器 -->
    <audio id="bg-music" loop src="https://ping763573.github.io/big-adventure/35.mp3"></audio>

    <!-- 導覽列 -->
    <nav class="navbar">
      <div class="nav-links">
        <a href="#title" data-lang-key="nav_home">首頁</a>
        <a href="#overview" data-lang-key="nav_overview">漢朝總覽</a>
        <a href="#timeline" data-lang-key="nav_timeline">大事年表</a>
        <a href="#territory" data-lang-key="nav_territory">疆域與地理</a>
        <a href="#emperors" data-lang-key="nav_emperors">帝王與制度</a>
        <a href="#government" data-lang-key="nav_government">思想與文化</a>
        <a href="#culture" data-lang-key="nav_culture">對外交流</a>
        <a href="#exchange" data-lang-key="nav_exchange">發明與科技</a>
        <a href="#scholars" data-lang-key="nav_scholars">衰亡與影響</a>
        <a href="#decline" data-lang-key="nav_decline">漢風遺產</a>
        <a href="#legacy" data-lang-key="nav_legacy">歷史遺產</a>
        <a href="#han-beauty-video" data-lang-key="nav_han_video">漢風美女</a>
      </div>
    </nav>

    <!-- 控制面板 -->
    <div class="control-panel">
      <button id="lang-toggle" class="control-btn" title="切換語言 / Language"><i class="fas fa-language"></i></button>
      <button id="autoplay-toggle" class="control-btn" title="自動播放 / Autoplay"><i class="fas fa-play"></i></button>
      <button id="fullscreen-toggle" class="control-btn" title="全螢幕 / Fullscreen"><i class="fas fa-expand"></i></button>
      <button id="music-toggle" class="control-btn" title="背景音樂 / Music"><i class="fas fa-volume-mute"></i></button>
      <button id="to-top-btn" class="control-btn" title="回到頂部 / Back to Top"><i class="fas fa-arrow-up"></i></button>
    </div>

    <!-- 主要內容區域 -->
    <main>

      <!-- 區塊 1: 標題頁 - 添加視頻背景 -->
      <section id="title" class="slide-section">
        <div class="video-container">
          <video autoplay loop muted playsinline>
            <source src="https://ping763573.github.io/history/01.mp4" type="video/mp4">
            您的瀏覽器不支援視頻播放。
          </video>
          <div class="video-overlay"></div>
        </div>
        <div class="border-pattern"></div>
        <div class="tang-decoration decoration-1"></div>
        <div class="tang-decoration decoration-2"></div>
        <div class="tang-decoration decoration-3"></div>
        <div class="tang-decoration decoration-4"></div>
        <div class="title-content">
          <h1 data-lang-key="title_main">盛世汉风<br>The Han Empire</h1>
          <div style="font-size: 2.5rem; font-weight: 600; color: var(--accent-color); margin-top: 15px; letter-spacing: 3px; font-family: var(--elegant-font);" data-lang-key="title_dates">西元前 202 - 西元 220 年</div>
          <h2 data-lang-key="title_subtitle">儒家治國，絲路通天，漢唐並輝之開端</h2>
          <p class="title-subtitle" data-lang-key="title_presenter">一場關於政治、文化與歷史遺產的全面探索<br>大學歷史課程</p>
        </div>
        <p class="copyright-notice" data-lang-key="copyright">展示照片與配樂其版權屬原創所有；純分享勿商用。</p>
      </section>

      <!-- 區塊 2: 漢朝總覽 -->
      <section id="overview" class="slide-section has-bg-image">
        <div class="w-full">
          <div class="content-container">
            <h2 class="section-title scroll-reveal" data-lang-key="overview_title">漢朝總覽：大一統帝國的基石</h2><button class="tts-btn ml-4 px-3 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600" data-tts-target data-lang-key="tts_play_btn">🔊 語音導讀</button>
            <div class="flex flex-col lg:flex-row items-center gap-12 mt-8">
              <div class="lg:w-3/5 scroll-reveal">
                <p class="text-xl leading-loose mb-6" data-lang-key="overview_p1">漢朝（西元前202年-西元220年）是中國歷史上第一個長期穩定的中央集權帝國，分為西漢（前202-8）和東漢（25-220）兩個階段。漢代確立了儒家思想的官方地位，開創了絲綢之路，奠定了中華文明的基本格局。</p>
                <p class="text-xl leading-loose" data-lang-key="overview_p2">漢代疆域廣闊，從朝鮮半島到西域，從嶺南到漠北，創造了"漢人"、"漢語"、"漢字"等文化概念，影響深遠至今。</p>
                <div class="info-card border-l-4 border-green-800 p-6 mt-8 rounded-lg">
                  <h3 class="font-bold text-2xl text-green-800 mb-4" data-lang-key="overview_key_title">核心特徵</h3>
                  <ul class="list-none p-0 space-y-3">
                    <li class="text-lg flex items-start"><i class="fas fa-check-circle text-yellow-600 mr-3 mt-1"></i><span data-lang-key="overview_key_1">推崇儒家治國思想</span></li>
                    <li class="text-lg flex items-start"><i class="fas fa-check-circle text-yellow-600 mr-3 mt-1"></i><span data-lang-key="overview_key_2">張騫出使西域，開啟絲綢之路</span></li>
                    <li class="text-lg flex items-start"><i class="fas fa-check-circle text-yellow-600 mr-3 mt-1"></i><span data-lang-key="overview_key_3">中央集權確立，郡縣制度強化</span></li>
                    <li class="text-lg flex items-start"><i class="fas fa-check-circle text-yellow-600 mr-3 mt-1"></i><span data-lang-key="overview_key_4">獨尊儒術，學術官辦</span></li>
                    <li class="text-lg flex items-start"><i class="fas fa-check-circle text-yellow-600 mr-3 mt-1"></i><span data-lang-key="overview_key_5">百姓安居樂業，疆域大擴張</span></li>
                  </ul>
                </div>
              </div>
              <div class="lg:w-2/5 scroll-reveal" style="transition-delay: 0.2s;">
                <div class="image-container-styled h-full">
                  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRf3sV8KrjFLKJ_eAbAv60xl25sJqkn5WuszA&s" alt="漢代官服與宮廷" onerror="this.onerror=null;this.src='https://placehold.co/600x800/42675A/F8F6F2?text=漢代宮廷'">
                </div>
                <p class="text-sm italic mt-3 text-right" data-lang-key="overview_img_caption">漢代官服與宮廷壁畫，展現漢代禮儀制度與藝術成就。</p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- 區塊 3: 視覺化時間軸 -->
      <section id="timeline" class="slide-section has-bg-image">
        <div class="w-full">
          <div class="content-container">
            <h2 class="section-title scroll-reveal" data-lang-key="timeline_title">大漢王朝興衰史</h2><button class="tts-btn ml-4 px-3 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600" data-tts-target data-lang-key="tts_play_btn">🔊 語音導讀</button>
            <div class="visual-timeline">
              <!-- Timeline items -->
              <div class="timeline-container left scroll-reveal"><div class="timeline-content"><h3 data-lang-key="timeline_1_title">前206年: 楚漢相爭</h3><p data-lang-key="timeline_1_desc">劉邦擊敗項羽，建立漢朝，是為漢高祖，定都長安，開啟西漢王朝。</p></div></div>
              <div class="timeline-container right scroll-reveal"><div class="timeline-content"><h3 data-lang-key="timeline_2_title">前141年: 漢武帝即位</h3><p data-lang-key="timeline_2_desc">漢武帝推行"罷黜百家，獨尊儒術"，開創漢朝鼎盛時期，國力強盛。</p></div></div>
              <div class="timeline-container left scroll-reveal"><div class="timeline-content"><h3 data-lang-key="timeline_3_title">前139年: 張騫通西域</h3><p data-lang-key="timeline_3_desc">張騫出使西域，開通絲綢之路，促進中西文化交流與經濟繁榮。</p></div></div>
              <div class="timeline-container right scroll-reveal"><div class="timeline-content"><h3 data-lang-key="timeline_4_title">8年: 王莽篡漢</h3><p data-lang-key="timeline_4_desc">王莽篡位建立新朝，實施激進改革，導致社會動盪，西漢滅亡。</p></div></div>
              <div class="timeline-container left scroll-reveal"><div class="timeline-content"><h3 data-lang-key="timeline_5_title">25年: 光武中興</h3><p data-lang-key="timeline_5_desc">劉秀重建漢朝，定都洛陽，開啟東漢時期，史稱"光武中興"。</p></div></div>
              <div class="timeline-container right scroll-reveal"><div class="timeline-content"><h3 data-lang-key="timeline_6_title">105年: 蔡倫造紙</h3><p data-lang-key="timeline_6_desc">蔡倫改良造紙術，促進文化傳播與教育發展，影響世界文明進程。</p></div></div>
              <div class="timeline-container left scroll-reveal"><div class="timeline-content"><h3 data-lang-key="timeline_7_title">184年: 黃巾之亂</h3><p data-lang-key="timeline_7_desc">張角領導黃巾起義，動搖東漢統治基礎，開啟軍閥割據時代。</p></div></div>
              <div class="timeline-container right scroll-reveal"><div class="timeline-content"><h3 data-lang-key="timeline_8_title">220年: 漢朝滅亡</h3><p data-lang-key="timeline_8_desc">漢獻帝被迫禪讓，曹丕建立魏國，標誌著漢朝正式滅亡，三國時代開始。</p></div></div>
            </div>
          </div>
        </div>
      </section>

      <!-- 區塊 4: 疆域與地理 -->
      <section id="territory" class="slide-section has-bg-image">
        <div class="w-full">
          <div class="content-container">
            <h2 class="section-title scroll-reveal" data-lang-key="territory_title">疆域與地理</h2><button class="tts-btn ml-4 px-3 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600" data-tts-target data-lang-key="tts_play_btn">🔊 語音導讀</button>
            <div class="flex flex-col lg:flex-row items-center gap-12 mt-8">
              <div class="lg:w-3/5 scroll-reveal">
                <div class="map-container-interactive mx-auto image-container-styled">
                  <img src="https://upload.wikimedia.org/wikipedia/commons/1/1e/%E6%B1%89%E9%AB%98%E5%B8%9D%E5%8D%81%E4%BA%8C%E5%B9%B4%E9%83%A1%E5%9B%BD.png" alt="漢代疆域圖" onerror="this.onerror=null;this.src='https://placehold.co/800x600/42675A/F8F6F2?text=漢代疆域圖'">
                  <div class="hotspot" style="top: 40%; left: 45%;" data-target="info-changan"><i class="fas fa-star"></i></div>
                  <div class="hotspot" style="top: 45%; left: 52%;" data-target="info-luoyang"><i class="fas fa-star"></i></div>
                  <div class="hotspot" style="top: 35%; left: 30%;" data-target="info-dunhuang"><i class="fas fa-star"></i></div>
                  <div id="info-changan" class="info-box" style="top: 40%; left: 42%;"><h3 data-lang-key="map_changan_title">長安 (西漢首都)</h3><p data-lang-key="map_changan_desc">西漢首都，位於關中平原，是當時世界上最大的城市之一，人口超過50萬。</p></div>
                  <div id="info-luoyang" class="info-box" style="top: 50%; left: 50%;"><h3 data-lang-key="map_luoyang_title">洛陽 (東漢首都)</h3><p data-lang-key="map_luoyang_desc">東漢首都，位於中原腹地，是絲綢之路東端的重要樞紐和文化中心。</p></div>
                  <div id="info-dunhuang" class="info-box" style="top: 60%; left: 48%;"><h3 data-lang-key="map_dunhuang_title">敦煌 (絲路要衝)</h3><p data-lang-key="map_dunhuang_desc">絲綢之路上的重要關隘，漢代設有玉門關和陽關，控制中西交通咽喉。</p></div>
                </div>
                <p class="text-sm italic mt-3 text-center" data-lang-key="territory_map_caption">漢代疆域圖，點擊地圖上的<i class="fas fa-star text-yellow-500"></i>圖標查看更多資訊。</p>
              </div>
              <div class="lg:w-2/5 scroll-reveal" style="transition-delay: 0.2s;">
                <p class="text-xl leading-loose mb-6" data-lang-key="territory_p1">漢朝疆域遼闊，西漢時期設立西域都護府，東漢時期勢力更達中亞地區。漢朝疆域東至朝鮮半島，西至蔥嶺，南至越南中部，北至大漠，奠定了中國的基本版圖。</p>
                <div class="info-card p-6 rounded-lg">
                  <h3 class="font-bold text-2xl text-green-800 mb-4" data-lang-key="territory_stats_title">領土數據</h3>
                  <div class="space-y-3">
                    <div class="flex justify-between text-lg border-b border-dotted border-yellow-500 pb-2"><span class="font-semibold" data-lang-key="territory_stats_1a">西漢疆域</span><span data-lang-key="territory_stats_1b">約600萬平方公里</span></div>
                    <div class="flex justify-between text-lg border-b border-dotted border-yellow-500 pb-2"><span class="font-semibold" data-lang-key="territory_stats_2a">東漢疆域</span><span data-lang-key="territory_stats_2b">約550萬平方公里</span></div>
                    <div class="flex justify-between text-lg border-b border-dotted border-yellow-500 pb-2"><span class="font-semibold" data-lang-key="territory_stats_3a">鼎盛人口</span><span data-lang-key="territory_stats_3b">約6,000萬 (西元2年)</span></div>
                    <div class="flex justify-between text-lg"><span class="font-semibold" data-lang-key="territory_stats_4a">主要首都</span><span data-lang-key="territory_stats_4b">長安 (西漢) / 洛陽 (東漢)</span></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- 區塊 5: 帝王與制度 -->
      <section id="emperors" class="slide-section has-bg-image">
        <div class="w-full">
          <div class="content-container">
            <h2 class="section-title scroll-reveal" data-lang-key="emperors_title">帝王與制度</h2><button class="tts-btn ml-4 px-3 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600" data-tts-target data-lang-key="tts_play_btn">🔊 語音導讀</button>
            <div class="h-60 w-full my-8 scroll-reveal">
              <canvas id="timelineChart"></canvas>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mt-4">
              <div class="styled-card scroll-reveal">
                <div class="image-container-styled mb-4" style="height: 200px;">
                  <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d5/Liu-bang.jpg/250px-Liu-bang.jpg" alt="漢高祖劉邦" onerror="this.onerror=null;this.src='https://placehold.co/400x400?text=劉邦'">
                </div>
                <div class="border-b-2 border-yellow-500 pb-2 mb-3">
                  <div class="text-3xl font-bold text-green-800" data-lang-key="emperor_1_name" style="font-family: var(--title-font);">漢高祖 (劉邦)</div>
                  <div class="text-gray-600" data-lang-key="emperor_1_reign">在位: 前202-前195</div>
                </div>
                <ul class="list-disc list-inside text-gray-700 space-y-2">
                  <li data-lang-key="emperor_1_feat1">擊敗項羽，建立漢朝</li>
                  <li data-lang-key="emperor_1_feat2">推行無為而治，恢復經濟</li>
                  <li data-lang-key="emperor_1_feat3">確立郡國並行制度</li>
                </ul>
              </div>
              <div class="styled-card scroll-reveal" style="transition-delay: 0.1s;">
                <div class="image-container-styled mb-4" style="height: 200px;">
                  <img src="https://5b0988e595225.cdn.sohucs.com/q_70,c_zoom,w_640/images/20180816/e8c103ac225d4f7cb63a367f06f98ecb.jpeg" alt="漢武帝劉徹" onerror="this.onerror=null;this.src='https://placehold.co/400x400?text=漢武帝'">
                </div>
                <div class="border-b-2 border-yellow-500 pb-2 mb-3">
                  <div class="text-3xl font-bold text-green-800" data-lang-key="emperor_2_name" style="font-family: var(--title-font);">漢武帝 (劉徹)</div>
                  <div class="text-gray-600" data-lang-key="emperor_2_reign">在位: 前141-前87</div>
                </div>
                <ul class="list-disc list-inside text-gray-700 space-y-2">
                  <li data-lang-key="emperor_2_feat1">罷黜百家，獨尊儒術</li>
                  <li data-lang-key="emperor_2_feat2">開拓西域，開通絲綢之路</li>
                  <li data-lang-key="emperor_2_feat3">北擊匈奴，南平百越</li>
                </ul>
              </div>
              <div class="styled-card scroll-reveal" style="transition-delay: 0.2s;">
                <div class="image-container-styled mb-4" style="height: 200px;">
                  <img src="https://upload.wikimedia.org/wikipedia/commons/6/62/Han_Guangwu_Di.jpg" alt="漢光武帝劉秀" onerror="this.onerror=null;this.src='https://placehold.co/400x400?text=劉秀'">
                </div>
                <div class="border-b-2 border-yellow-500 pb-2 mb-3">
                  <div class="text-3xl font-bold text-green-800" data-lang-key="emperor_3_name" style="font-family: var(--title-font);">漢光武帝 (劉秀)</div>
                  <div class="text-gray-600" data-lang-key="emperor_3_reign">在位: 25-57</div>
                </div>
                <ul class="list-disc list-inside text-gray-700 space-y-2">
                  <li data-lang-key="emperor_3_feat1">重建漢朝，史稱"光武中興"</li>
                  <li data-lang-key="emperor_3_feat2">整頓吏治，減輕賦稅</li>
                  <li data-lang-key="emperor_3_feat3">強化中央集權，削弱諸侯</li>
                </ul>
              </div>
              <div class="styled-card scroll-reveal" style="transition-delay: 0.3s;">
                <div class="image-container-styled mb-4" style="height: 200px;">
                  <img src="https://upload.wikimedia.org/wikipedia/commons/7/7a/Emperor_Xian_Qing_illustration.jpg" alt="漢獻帝劉協" onerror="this.onerror=null;this.src='https://placehold.co/400x400?text=漢獻帝'">
                </div>
                <div class="border-b-2 border-yellow-500 pb-2 mb-3">
                  <div class="text-3xl font-bold text-green-800" data-lang-key="emperor_4_name" style="font-family: var(--title-font);">漢獻帝 (劉協)</div>
                  <div class="text-gray-600" data-lang-key="emperor_4_reign">在位: 189-220</div>
                </div>
                <ul class="list-disc list-inside text-gray-700 space-y-2">
                  <li data-lang-key="emperor_4_feat1">東漢末代皇帝</li>
                  <li data-lang-key="emperor_4_feat2">被董卓、曹操等權臣控制</li>
                  <li data-lang-key="emperor_4_feat3">被迫禪讓，漢朝滅亡</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- 區塊 6: 思想與文化 -->
      <section id="government" class="slide-section has-bg-image">
        <div class="w-full">
          <div class="content-container">
            <h2 class="section-title scroll-reveal" data-lang-key="gov_title">思想與文化</h2><button class="tts-btn ml-4 px-3 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600" data-tts-target data-lang-key="tts_play_btn">🔊 語音導讀</button>
            <div class="flex flex-col lg:flex-row items-center gap-12 mt-8">
              <div class="lg:w-1/2 flex flex-col gap-8">
                <div class="styled-card scroll-reveal">
                  <h3 class="text-2xl text-green-800 mb-3 flex items-center font-bold"><i class="fas fa-university mr-4 text-yellow-600 text-3xl"></i><span data-lang-key="gov_box1_title">獨尊儒術</span></h3>
                  <p class="leading-relaxed" data-lang-key="gov_box1_desc">漢武帝採納董仲舒建議，推行"罷黜百家，獨尊儒術"，使儒家思想成為國家正統意識形態，影響中國兩千年。</p>
                </div>
                <div class="styled-card scroll-reveal" style="transition-delay: 0.1s;">
                  <h3 class="text-2xl text-green-800 mb-3 flex items-center font-bold"><i class="fas fa-landmark mr-4 text-yellow-600 text-3xl"></i><span data-lang-key="gov_box2_title">太學制度</span></h3>
                  <p class="leading-relaxed" data-lang-key="gov_box2_desc">漢武帝設立太學，為國家最高學府，培養儒家人才，開啟了中國古代官辦教育的先河。</p>
                </div>
                <div class="styled-card scroll-reveal" style="transition-delay: 0.2s;">
                  <h3 class="text-2xl text-green-800 mb-3 flex items-center font-bold"><i class="fas fa-shield-alt mr-4 text-yellow-600 text-3xl"></i><span data-lang-key="gov_box3_title">禮樂制度</span></h3>
                  <p class="leading-relaxed" data-lang-key="gov_box3_desc">漢代恢復並完善了周代的禮樂制度，確立了以儒家禮儀為核心的國家儀典體系。</p>
                </div>
              </div>
              <div class="lg:w-1/2 scroll-reveal" style="transition-delay: 0.3s;">
                <div class="h-96 w-full p-4 bg-white/80 rounded-lg shadow-inner">
                  <canvas id="governmentChart"></canvas>
                </div>
                <p class="text-center mt-4 text-sm" data-lang-key="gov_chart_caption">圖表顯示漢代思想流派影響力變化，儒家（綠色）在漢武帝後成為主導思想，其他流派（灰色）影響力相對下降。</p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- 區塊 7: 對外交流 -->
      <section id="culture" class="slide-section has-bg-image">
        <div class="w-full">
          <div class="content-container">
            <h2 class="section-title scroll-reveal" data-lang-key="culture_title">對外交流</h2><button class="tts-btn ml-4 px-3 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600" data-tts-target data-lang-key="tts_play_btn">🔊 語音導讀</button>
            <p class="text-center text-xl max-w-4xl mx-auto mb-12 scroll-reveal leading-relaxed" data-lang-key="culture_intro">漢代是中國歷史上第一個大規模對外交流的時代，通過絲綢之路，漢朝與西域、中亞、南亞甚至羅馬帝國建立了聯繫，開啟了中外文化交流的新篇章。</p>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-10">
              <div class="styled-card flex flex-col md:flex-row bg-white overflow-hidden scroll-reveal">
                <div class="image-container-styled md:w-1/3 flex-shrink-0">
                  <img src="https://upload.wikimedia.org/wikipedia/commons/6/6c/Zhangqianwest3.jpg" alt="張騫出使西域" onerror="this.onerror=null;this.src='https://placehold.co/400x600?text=絲綢之路'">
                </div>
                <div class="p-5 flex flex-col justify-center flex-grow">
                  <h3 class="text-2xl text-green-800 font-bold mb-3 flex items-center"><i class="fas fa-pen-fancy mr-3 text-yellow-600"></i><span data-lang-key="culture_card1_title">張騫通西域</span></h3>
                  <p data-lang-key="culture_card1_desc">張騫兩次出使西域，開通了連接中原與中亞的絲綢之路，促進了中西經濟文化交流。</p>
                  <div class="text-lg italic text-gray-700 mt-4 pl-4 border-l-4 border-yellow-500" data-lang-key="culture_card1_quote" style="font-family: var(--cursive-font);">"鑿空西域，開通絲路，功在千秋。" <br>— 司馬遷</div>
                </div>
              </div>
              <div class="styled-card flex flex-col md:flex-row bg-white overflow-hidden scroll-reveal" style="transition-delay: 0.1s;">
                <div class="image-container-styled md:w-1/3 flex-shrink-0">
                  <img src="https://paper.people.com.cn/zgcsb/res/2017-05/22/28/zgcsb2017052228p21_b.jpg" alt="絲路貿易" onerror="this.onerror=null;this.src='https://placehold.co/400x600?text=絲路貿易'">
                </div>
                <div class="p-5 flex flex-col justify-center flex-grow">
                  <h3 class="text-2xl text-green-800 font-bold mb-3 flex items-center"><i class="fas fa-gem mr-3 text-yellow-600"></i><span data-lang-key="culture_card2_title">東西文化交流</span></h3>
                  <p data-lang-key="culture_card2_desc">絲綢之路不僅是商貿通道，更是文化交流橋梁。佛教經此傳入中國，中國的絲綢、鐵器、造紙術等也傳向西方。</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- 區塊 8: 發明與科技 -->
      <section id="exchange" class="slide-section has-bg-image">
        <div class="w-full">
          <div class="content-container">
            <h2 class="section-title scroll-reveal" data-lang-key="exchange_title">發明與科技</h2><button class="tts-btn ml-4 px-3 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600" data-tts-target data-lang-key="tts_play_btn">🔊 語音導讀</button>
            <div class="flex flex-col lg:flex-row items-center gap-12 mt-8">
              <div class="lg:w-3/5">
                <p class="text-xl leading-loose mb-8 scroll-reveal" data-lang-key="exchange_intro">漢代是中國古代科技發展的重要時期，在造紙術、天文曆法、醫學等領域取得了突破性進展，為後世科技發展奠定了基礎。</p>
                <div class="space-y-6">
                  <div class="styled-card scroll-reveal" style="transition-delay: 0.1s;">
                    <h3 class="text-xl font-bold text-green-800 mb-2 flex items-center"><i class="fas fa-ship mr-3 text-yellow-600"></i><span data-lang-key="exchange_box1_title">蔡倫造紙</span></h3>
                    <p data-lang-key="exchange_box1_desc">東漢蔡倫改良造紙術，用樹皮、麻頭、破布等原料造紙，使紙張生產成本降低，質量提高，促進文化傳播。</p>
                  </div>
                  <div class="styled-card scroll-reveal" style="transition-delay: 0.2s;">
                    <h3 class="text-xl font-bold text-green-800 mb-2 flex items-center"><i class="fas fa-landmark mr-3 text-yellow-600"></i><span data-lang-key="exchange_box2_title">張衡地動儀</span></h3>
                    <p data-lang-key="exchange_box2_desc">張衡發明候風地動儀，是世界上最早的地震探測儀器，體現了漢代在天文地理領域的卓越成就。</p>
                  </div>
                </div>
              </div>
              <div class="lg:w-2/5 scroll-reveal" style="transition-delay: 0.3s;">
                <div class="h-80 w-full mb-8 p-4 bg-white/80 rounded-lg shadow-inner">
                  <canvas id="relationChart"></canvas>
                </div>
                <div class="image-container-styled">
                    <img src="https://images.storm.mg/gallery/310291/20181011-102742_U5965_M461771_ec0a.jpg" alt="張衡地動儀" class="w-full rounded-lg" onerror="this.onerror=null;this.src='https://placehold.co/600x400?text=地動儀'">
                </div>
                <p class="text-sm italic mt-3 text-center" data-lang-key="exchange_img_caption">張衡發明的候風地動儀復原圖，展現漢代科技成就。</p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- 區塊 9: 衰亡與影響 - 替換圖片 -->
      <section id="scholars" class="slide-section has-bg-image">
        <div class="w-full">
          <div class="content-container">
            <h2 class="section-title scroll-reveal" data-lang-key="scholars_title">衰亡與歷史影響</h2><button class="tts-btn ml-4 px-3 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600" data-tts-target data-lang-key="tts_play_btn">🔊 語音導讀</button>
            <p class="text-center text-xl max-w-4xl mx-auto mb-12 scroll-reveal leading-relaxed" data-lang-key="scholars_intro">漢朝後期，政治腐敗、外戚專權、土地兼併嚴重，加上自然災害頻發，最終導致黃巾起義爆發，漢朝統治瓦解，中國進入三國鼎立時期。</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
              <div class="scholar-card scroll-reveal">
                <div class="scholar-img">
                  <!-- 替換黃巾之亂圖片 -->
                  <img src="https://p5.itc.cn/images01/20220115/ce94ff8e43ca487d8c4ed502e6bd52bf.jpeg" alt="黃巾起義" onerror="this.onerror=null;this.src='https://placehold.co/600x400?text=黃巾起義'">
                </div>
                <div class="scholar-content">
                  <h3 class="scholar-name" data-lang-key="scholar_1_name">黃巾之亂</h3>
                  <p class="scholar-desc" data-lang-key="scholar_1_desc">張角領導的農民起義，動搖了東漢統治基礎，導致地方軍閥割據，中央權威喪失。</p>
                </div>
              </div>
              
              <div class="scholar-card scroll-reveal" style="transition-delay: 0.1s;">
                <div class="scholar-img">
                  <!-- 替換外戚宦官之爭圖片 -->
                  <img src="https://i1.kknews.cc/AvhOw-gc1bXuCvooYhtiN1KpTAxEi6FA6caQN2A/0.jpg" alt="董卓專權" onerror="this.onerror=null;this.src='https://placehold.co/600x400?text=董卓專權'">
                </div>
                <div class="scholar-content">
                  <h3 class="scholar-name" data-lang-key="scholar_2_name">外戚宦官之爭</h3>
                  <p class="scholar-desc" data-lang-key="scholar_2_desc">東漢後期外戚與宦官交替專權，政治腐敗，加劇了社會矛盾。</p>
                </div>
              </div>
              
              <div class="scholar-card scroll-reveal" style="transition-delay: 0.2s;">
                <div class="scholar-img">
                  <img src="https://www.chinawenhua.com.cn/uploads/allimg/190203/1-1Z2031U91VV.jpg" alt="三國鼎立" onerror="this.onerror=null;this.src='https://placehold.co/600x400?text=三國鼎立'">
                </div>
                <div class="scholar-content">
                  <h3 class="scholar-name" data-lang-key="scholar_3_name">軍閥割據</h3>
                  <p class="scholar-desc" data-lang-key="scholar_3_desc">黃巾起義後，各地軍閥擁兵自重，形成割據局面，最終導致漢朝滅亡。</p>
                </div>
              </div>
              
              <div class="scholar-card scroll-reveal" style="transition-delay: 0.3s;">
                <div class="scholar-img">
                  <img src="https://img.soundofhope.org/2022-06/1000-1637117089927-1655915361277.jpg" alt="漢獻帝禪讓" onerror="this.onerror=null;this.src='https://placehold.co/600x400?text=漢獻帝'">
                </div>
                <div class="scholar-content">
                  <h3 class="scholar-name" data-lang-key="scholar_4_name">漢朝滅亡</h3>
                  <p class="scholar-desc" data-lang-key="scholar_4_desc">220年，漢獻帝被迫禪讓，曹丕稱帝，標誌著延續四百餘年的漢朝正式滅亡。</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- 區塊 10: 漢風遺產 -->
      <section id="decline" class="slide-section has-bg-image">
        <div class="w-full">
          <div class="content-container">
            <h2 class="section-title scroll-reveal" data-lang-key="decline_title">漢風遺產</h2><button class="tts-btn ml-4 px-3 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600" data-tts-target data-lang-key="tts_play_btn">🔊 語音導讀</button>
            <div class="flex flex-col lg:flex-row items-center gap-12 mt-8">
              <div class="lg:w-1/2 scroll-reveal">
                <div class="h-96 w-full p-4 bg-white/80 rounded-lg shadow-inner">
                  <canvas id="declineChart"></canvas>
                </div>
                <p class="text-center mt-4 text-sm" data-lang-key="decline_chart_caption">圖表直觀顯示了漢朝對後世的影響力（綠色）隨時間變化，其文化影響深遠持久。</p>
              </div>
              <div class="lg:w-1/2 flex flex-col gap-8 scroll-reveal" style="transition-delay: 0.2s;">
                <div class="styled-card">
                  <h3 class="text-2xl text-green-800 mb-3 flex items-center font-bold"><i class="fas fa-mountain mr-4 text-yellow-600 text-3xl"></i><span data-lang-key="decline_box1_title">文化認同</span></h3>
                  <p class="leading-relaxed" data-lang-key="decline_box1_desc">漢朝確立了"漢族"、"漢語"、"漢字"等文化概念，成為中華民族的核心認同。</p>
                </div>
                <div class="styled-card">
                  <h3 class="text-2xl text-green-800 mb-3 flex items-center font-bold"><i class="fas fa-water mr-4 text-yellow-600 text-3xl"></i><span data-lang-key="decline_box2_title">制度遺產</span></h3>
                  <p class="leading-relaxed" data-lang-key="decline_box2_desc">漢朝創立的中央集權制度、郡縣制度、察舉制度等，成為後世王朝的基本政治框架。</p>
                </div>
                <div class="styled-card">
                  <h3 class="text-2xl text-green-800 mb-3 flex items-center font-bold"><i class="fas fa-water mr-4 text-yellow-600 text-3xl"></i><span data-lang-key="decline_box3_title">漢服復興</span></h3>
                  <p class="leading-relaxed" data-lang-key="decline_box3_desc">當代漢服運動復興了漢代服飾文化，成為中國傳統文化復興的重要象徵。</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- 區塊 11: 歷史遺產 -->
      <section id="legacy" class="slide-section has-bg-image">
        <div class="w-full">
          <div class="content-container">
            <h2 class="section-title scroll-reveal" data-lang-key="legacy_title">歷史遺產</h2><button class="tts-btn ml-4 px-3 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600" data-tts-target data-lang-key="tts_play_btn">🔊 語音導讀</button>
            <p class="text-center text-xl max-w-4xl mx-auto mb-12 scroll-reveal leading-relaxed" data-lang-key="legacy_intro">漢朝雖已滅亡近兩千年，但其創造的文明成果深刻影響了中國乃至整個東亞世界的發展，漢文化成為東亞文明的核心。</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
              <div class="styled-card scroll-reveal">
                <h3 class="text-xl font-bold text-green-800 mb-3 flex items-center"><i class="fas fa-university mr-3 text-yellow-600"></i><span data-lang-key="legacy_box1_title">思想遺產</span></h3>
                <p class="leading-relaxed" data-lang-key="legacy_box1_desc">漢代確立的儒家正統地位，成為中國兩千年來的主流思想，影響政治、教育、社會倫理等各個方面。</p>
              </div>
              <div class="styled-card scroll-reveal" style="transition-delay: 0.1s;">
                <h3 class="text-xl font-bold text-green-800 mb-3 flex items-center"><i class="fas fa-palette mr-3 text-yellow-600"></i><span data-lang-key="legacy_box2_title">文化遺產</span></h3>
                <p class="leading-relaxed" data-lang-key="legacy_box2_desc">漢賦、漢隸、漢畫像石等文化藝術形式，成為中國傳統藝術的重要源頭，影響深遠。</p>
              </div>
            </div>
            <div class="quote-block p-8 my-8 scroll-reveal rounded-lg">
              <p class="text-2xl italic leading-relaxed" data-lang-key="legacy_quote">"漢代是中國歷史上第一個長期穩定的大一統帝國，其政治制度、文化成就和疆域規模，為後世中國奠定了基本格局。"</p>
              <p class="text-right font-semibold mt-4 text-lg" data-lang-key="legacy_quote_author">— 錢穆，中國歷史學家</p>
            </div>
          </div>
        </div>
      </section>

      <!-- 區塊 12: 漢風美女視頻 -->
      <section id="han-beauty-video" class="slide-section has-bg-image">
        <div class="w-full">
          <div class="content-container">
            <h2 class="section-title scroll-reveal" data-lang-key="han_video_title">漢代國風美女視頻</h2><button class="tts-btn ml-4 px-3 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600" data-tts-target data-lang-key="tts_play_btn">🔊 語音導讀</button>
            
            <div class="scroll-reveal my-8" style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; border-radius: 15px; box-shadow: 0 15px 40px rgba(0,0,0,0.3); border: 3px solid var(--accent-light);">
              <iframe 
                style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"
                src="https://drive.google.com/file/d/1n_LCj-EFn0x0SwXJ2S2Cfn3DRxxLp9lB/preview" 
                title="Google Drive video player" 
                frameborder="0" 
                allow="autoplay; fullscreen" 
                allowfullscreen>
              </iframe>
            </div>

            <p class="text-xl leading-loose max-w-4xl mx-auto mt-10 scroll-reveal" data-lang-key="han_video_desc">
              <!-- Content will be injected by JavaScript -->
            </p>
          </div>
        </div>
      </section>

    </main>

    <script>
    // --- 翻譯資料 ---
    const translations = {
      'zh-TW': {
        nav_home: '首頁', nav_overview: '漢朝總覽', nav_timeline: '大事年表', nav_territory: '疆域與地理', nav_emperors: '帝王與制度', nav_government: '思想與文化', nav_culture: '對外交流', nav_exchange: '發明與科技', nav_scholars: '衰亡與影響', nav_decline: '漢風遺產', nav_legacy: '歷史遺產', nav_han_video: '漢風美女',
        title_main: '盛世汉风<br>The Han Empire', title_dates: '西元前 202 - 西元 220 年', title_subtitle: '儒家治國，絲路通天，漢唐並輝之開端', title_presenter: '一場關於政治、文化與歷史遺產的全面探索<br>大學歷史課程',
        copyright: '展示照片與配樂其版權屬原創所有；純分享勿商用。',
        tts_play_btn: '🔊 語音導讀', tts_stop_btn: '⏹️ 停止導讀',
        overview_title: '漢朝總覽：大一統帝國的基石',
        overview_p1: '漢朝（西元前202年-西元220年）是中國歷史上第一個長期穩定的中央集權帝國，分為西漢（前202-8）和東漢（25-220）兩個階段。漢代確立了儒家思想的官方地位，開創了絲綢之路，奠定了中華文明的基本格局。',
        overview_p2: '漢代疆域廣闊，從朝鮮半島到西域，從嶺南到漠北，創造了"漢人"、"漢語"、"漢字"等文化概念，影響深遠至今。',
        overview_key_title: '核心特徵',
        overview_key_1: '推崇儒家治國思想', overview_key_2: '張騫出使西域，開啟絲綢之路', overview_key_3: '中央集權確立，郡縣制度強化', overview_key_4: '獨尊儒術，學術官辦', overview_key_5: '百姓安居樂業，疆域大擴張',
        overview_img_caption: '漢代官服與宮廷壁畫，展現漢代禮儀制度與藝術成就。',
        timeline_title: '大漢王朝興衰史',
        timeline_1_title: '前206年: 楚漢相爭', timeline_1_desc: '劉邦擊敗項羽，建立漢朝，是為漢高祖，定都長安，開啟西漢王朝。',
        timeline_2_title: '前141年: 漢武帝即位', timeline_2_desc: '漢武帝推行"罷黜百家，獨尊儒術"，開創漢朝鼎盛時期，國力強盛。',
        timeline_3_title: '前139年: 張騫通西域', timeline_3_desc: '張騫出使西域，開通絲綢之路，促進中西文化交流與經濟繁榮。',
        timeline_4_title: '8年: 王莽篡漢', timeline_4_desc: '王莽篡位建立新朝，實施激進改革，導致社會動盪，西漢滅亡。',
        timeline_5_title: '25年: 光武中興', timeline_5_desc: '劉秀重建漢朝，定都洛陽，開啟東漢時期，史稱"光武中興"。',
        timeline_6_title: '105年: 蔡倫造紙', timeline_6_desc: '蔡倫改良造紙術，促進文化傳播與教育發展，影響世界文明進程。',
        timeline_7_title: '184年: 黃巾之亂', timeline_7_desc: '張角領導黃巾起義，動搖東漢統治基礎，開啟軍閥割據時代。',
        timeline_8_title: '220年: 漢朝滅亡', timeline_8_desc: '漢獻帝被迫禪讓，曹丕建立魏國，標誌著漢朝正式滅亡，三國時代開始。',
        territory_title: '疆域與地理',
        territory_map_caption: '漢代疆域圖，點擊地圖上的<i class="fas fa-star text-yellow-500"></i>圖標查看更多資訊。',
        territory_p1: '漢朝疆域遼闊，西漢時期設立西域都護府，東漢時期勢力更達中亞地區。漢朝疆域東至朝鮮半島，西至蔥嶺，南至越南中部，北至大漠，奠定了中國的基本版圖。',
        territory_stats_title: '領土數據',
        territory_stats_1a: '西漢疆域', territory_stats_1b: '約600萬平方公里',
        territory_stats_2a: '東漢疆域', territory_stats_2b: '約550萬平方公里',
        territory_stats_3a: '鼎盛人口', territory_stats_3b: '約6,000萬 (西元2年)',
        territory_stats_4a: '主要首都', territory_stats_4b: '長安 (西漢) / 洛陽 (東漢)',
        map_changan_title: '長安 (西漢首都)', map_changan_desc: '西漢首都，位於關中平原，是當時世界上最大的城市之一，人口超過50萬。',
        map_luoyang_title: '洛陽 (東漢首都)', map_luoyang_desc: '東漢首都，位於中原腹地，是絲綢之路東端的重要樞紐和文化中心。',
        map_dunhuang_title: '敦煌 (絲路要衝)', map_dunhuang_desc: '絲綢之路上的重要關隘，漢代設有玉門關和陽關，控制中西交通咽喉。',
        emperors_title: '帝王與制度',
        emperor_1_name: '漢高祖 (劉邦)', emperor_1_reign: '在位: 前202-前195', emperor_1_feat1: '擊敗項羽，建立漢朝', emperor_1_feat2: '推行無為而治，恢復經濟', emperor_1_feat3: '確立郡國並行制度',
        emperor_2_name: '漢武帝 (劉徹)', emperor_2_reign: '在位: 前141-前87', emperor_2_feat1: '罷黜百家，獨尊儒術', emperor_2_feat2: '開拓西域，開通絲綢之路', emperor_2_feat3: '北擊匈奴，南平百越',
        emperor_3_name: '漢光武帝 (劉秀)', emperor_3_reign: '在位: 25-57', emperor_3_feat1: '重建漢朝，史稱"光武中興"', emperor_3_feat2: '整頓吏治，減輕賦稅', emperor_3_feat3: '強化中央集權，削弱諸侯',
        emperor_4_name: '漢獻帝 (劉協)', emperor_4_reign: '在位: 189-220', emperor_4_feat1: '東漢末代皇帝', emperor_4_feat2: '被董卓、曹操等權臣控制', emperor_4_feat3: '被迫禪讓，漢朝滅亡',
        gov_title: '思想與文化',
        gov_box1_title: '獨尊儒術', gov_box1_desc: '漢武帝採納董仲舒建議，推行"罷黜百家，獨尊儒術"，使儒家思想成為國家正統意識形態，影響中國兩千年。',
        gov_box2_title: '太學制度', gov_box2_desc: '漢武帝設立太學，為國家最高學府，培養儒家人才，開啟了中國古代官辦教育的先河。',
        gov_box3_title: '禮樂制度', gov_box3_desc: '漢代恢復並完善了周代的禮樂制度，確立了以儒家禮儀為核心的國家儀典體系。',
        gov_chart_caption: '圖表顯示漢代思想流派影響力變化，儒家（綠色）在漢武帝後成為主導思想，其他流派（灰色）影響力相對下降。',
        culture_title: '對外交流',
        culture_intro: '漢代是中國歷史上第一個大規模對外交流的時代，通過絲綢之路，漢朝與西域、中亞、南亞甚至羅馬帝國建立了聯繫，開啟了中外文化交流的新篇章。',
        culture_card1_title: '張騫通西域', culture_card1_desc: '張騫兩次出使西域，開通了連接中原與中亞的絲綢之路，促進了中西經濟文化交流。',
        culture_card1_quote: '"鑿空西域，開通絲路，功在千秋。" <br>— 司馬遷',
        culture_card2_title: '東西文化交流', culture_card2_desc: '絲綢之路不僅是商貿通道，更是文化交流橋梁。佛教經此傳入中國，中國的絲綢、鐵器、造紙術等也傳向西方。',
        exchange_title: '發明與科技',
        exchange_intro: '漢代是中國古代科技發展的重要時期，在造紙術、天文曆法、醫學等領域取得了突破性進展，為後世科技發展奠定了基礎。',
        exchange_box1_title: '蔡倫造紙', exchange_box1_desc: '東漢蔡倫改良造紙術，用樹皮、麻頭、破布等原料造紙，使紙張生產成本降低，質量提高，促進文化傳播。',
        exchange_box2_title: '張衡地動儀', exchange_box2_desc: '張衡發明候風地動儀，是世界上最早的地震探測儀器，體現了漢代在天文地理領域的卓越成就。',
        exchange_img_caption: '張衡發明的候風地動儀復原圖，展現漢代科技成就。',
        scholars_title: '衰亡與歷史影響',
        scholars_intro: '漢朝後期，政治腐敗、外戚專權、土地兼併嚴重，加上自然災害頻發，最終導致黃巾起義爆發，漢朝統治瓦解，中國進入三國鼎立時期。',
        scholar_1_name: '黃巾之亂', scholar_1_desc: '張角領導的農民起義，動搖了東漢統治基礎，導致地方軍閥割據，中央權威喪失。',
        scholar_2_name: '外戚宦官之爭', scholar_2_desc: '東漢後期外戚與宦官交替專權，政治腐敗，加劇了社會矛盾。',
        scholar_3_name: '軍閥割據', scholar_3_desc: '黃巾起義後，各地軍閥擁兵自重，形成割據局面，最終導致漢朝滅亡。',
        scholar_4_name: '漢朝滅亡', scholar_4_desc: '220年，漢獻帝被迫禪讓，曹丕稱帝，標誌著延續四百餘年的漢朝正式滅亡。',
        decline_title: '漢風遺產',
        decline_chart_caption: '圖表直觀顯示了漢朝對後世的影響力（綠色）隨時間變化，其文化影響深遠持久。',
        decline_box1_title: '文化認同', decline_box1_desc: '漢朝確立了"漢族"、"漢語"、"漢字"等文化概念，成為中華民族的核心認同。',
        decline_box2_title: '制度遺產', decline_box2_desc: '漢朝創立的中央集權制度、郡縣制度、察舉制度等，成為後世王朝的基本政治框架。',
        decline_box3_title: '漢服復興', decline_box3_desc: '當代漢服運動復興了漢代服飾文化，成為中國傳統文化復興的重要象徵。',
        legacy_title: '歷史遺產',
        legacy_intro: '漢朝雖已滅亡近兩千年，但其創造的文明成果深刻影響了中國乃至整個東亞世界的發展，漢文化成為東亞文明的核心。',
        legacy_box1_title: '思想遺產', legacy_box1_desc: '漢代確立的儒家正統地位，成為中國兩千年來的主流思想，影響政治、教育、社會倫理等各個方面。',
        legacy_box2_title: '文化遺產', legacy_box2_desc: '漢賦、漢隸、漢畫像石等文化藝術形式，成為中國傳統藝術的重要源頭，影響深遠。',
        legacy_quote: '"漢代是中國歷史上第一個長期穩定的大一統帝國，其政治制度、文化成就和疆域規模，為後世中國奠定了基本格局。"',
        legacy_quote_author: '— 錢穆，中國歷史學家',
        han_video_title: '漢代國風美女視頻',
        han_video_desc: '<strong>漢家風華：服飾與妝容</strong><br><br>漢代女子的服飾，以其典雅莊重、氣勢恢宏而著稱，充分體現了大一統王朝的自信與文化底蘊。早期流行將衣裾在身後層層纏繞的「曲裾」，後期則以簡潔大方的「直裾」為主。寬大的袖口、層疊的穿搭以及精美的刺繡，共同構成了漢服的獨特魅力。<br><br>髮型與妝容同樣精緻。女子多梳理高聳的髮髻，飾以華麗的髮簪、步搖。妝容上，以白為美，敷上白粉，再點上朱色的唇脂與臉頰，眉毛則描畫得細長彎曲，整體風格端莊而不失嫵媚，展現了漢代女性獨特的審美情趣與時代風貌。',
        chart_timeline_labels: ['高祖', '武帝', '光武帝', '獻帝', '晚期'],
        chart_gov_title: '漢代思想影響力',
        chart_gov_label_central: '儒家思想', chart_gov_label_provincial: '其他思想流派', chart_gov_yaxis: '影響力指數',
        chart_rel_title: '漢代對外交流範圍',
        chart_rel_label: '交流強度', chart_rel_cats: ['匈奴', '西域', '朝鮮', '南越', '印度', '羅馬'],
        chart_dec_title: '漢朝對後世影響力',
        chart_dec_label_central: '漢文化影響力', chart_dec_label_regional: '其他文化影響', chart_dec_yaxis: '影響力指數',
      },
      'en': {
        nav_home: 'Home', nav_overview: 'Overview', nav_timeline: 'Timeline', nav_territory: 'Territory', nav_emperors: 'Emperors', nav_government: 'Culture', nav_culture: 'Exchange', nav_exchange: 'Inventions', nav_scholars: 'Decline', nav_decline: 'Legacy', nav_legacy: 'Historical Legacy', nav_han_video: 'Han Beauty',
        title_main: 'The Han Empire', title_dates: '202 BCE - 220 CE', title_subtitle: 'Confucian Governance, Silk Road, The Foundation of Chinese Civilization', title_presenter: 'A Comprehensive Exploration of Politics, Culture and Legacy<br>University History Course',
        copyright: 'Photos and music copyright belong to original creators. For sharing only, not for commercial use.',
        tts_play_btn: '🔊 Read Aloud', tts_stop_btn: '⏹️ Stop Reading',
        overview_title: 'Overview: Foundation of the Unified Empire',
        overview_p1: 'The Han Dynasty (202 BCE - 220 CE) was the first long-term stable centralized empire in Chinese history, divided into the Western Han (202 BCE - 8 CE) and Eastern Han (25-220 CE) periods.',
        overview_p2: 'With vast territories spanning from the Korean Peninsula to Central Asia, the Han Dynasty established Confucianism as the state ideology, pioneered the Silk Road, and laid the foundation for Chinese civilization.',
        overview_key_title: 'Key Features',
        overview_key_1: 'Advocacy of Confucian governance', overview_key_2: 'Zhang Qian\'s mission to the Western Regions', overview_key_3: 'Centralized authority and county system', overview_key_4: 'Exclusive reverence for Confucianism', overview_key_5: 'Territorial expansion and population growth',
        overview_img_caption: 'Han official robes and court murals, showcasing Han ritual systems and artistic achievements.',
        timeline_title: 'Rise and Fall of the Han Dynasty',
        timeline_1_title: '206 BCE: Chu-Han Contention', timeline_1_desc: 'Liu Bang defeated Xiang Yu, established the Han Dynasty, known as Emperor Gaozu of Han.',
        timeline_2_title: '141 BCE: Emperor Wu Ascends', timeline_2_desc: 'Emperor Wu promoted Confucianism as state ideology, ushering in the Han golden age.',
        timeline_3_title: '139 BCE: Zhang Qian to West', timeline_3_desc: 'Zhang Qian\'s missions opened the Silk Road, facilitating cultural exchange.',
        timeline_4_title: '8 CE: Wang Mang Usurps', timeline_4_desc: 'Wang Mang seized power, established Xin Dynasty, leading to social chaos.',
        timeline_5_title: '25 CE: Guangwu Restores', timeline_5_desc: 'Liu Xiu restored the Han Dynasty, known as the "Guangwu Restoration".',
        timeline_6_title: '105 CE: Cai Lun Paper', timeline_6_desc: 'Cai Lun improved papermaking, revolutionizing communication and education.',
        timeline_7_title: '184 CE: Yellow Turban', timeline_7_desc: 'Yellow Turban Rebellion weakened Eastern Han rule, leading to warlordism.',
        timeline_8_title: '220 CE: Han Dynasty Ends', timeline_8_desc: 'Emperor Xian abdicated, Cao Pi established Wei, beginning Three Kingdoms period.',
        territory_title: 'Territory & Geography',
        territory_map_caption: 'Han Dynasty territory map. Click <i class="fas fa-star text-yellow-500"></i> icons for more info.',
        territory_p1: 'The Han Dynasty had vast territories stretching from Korea to Central Asia, establishing the Protectorate of the Western Regions.',
        territory_stats_title: 'Territorial Statistics',
        territory_stats_1a: 'W. Han Area', territory_stats_1b: '≈6M km²',
        territory_stats_2a: 'E. Han Area', territory_stats_2b: '≈5.5M km²',
        territory_stats_3a: 'Peak Population', territory_stats_3b: '≈60M (2 CE)',
        territory_stats_4a: 'Main Capitals', territory_stats_4b: 'Chang\'an (W. Han) / Luoyang (E. Han)',
        map_changan_title: 'Chang\'an (W. Han Capital)', map_changan_desc: 'Western Han capital, one of the world\'s largest cities with over 500,000 people.',
        map_luoyang_title: 'Luoyang (E. Han Capital)', map_luoyang_desc: 'Eastern Han capital, key hub on the eastern end of the Silk Road.',
        map_dunhuang_title: 'Dunhuang (Silk Road)', map_dunhuang_desc: 'Crucial pass on Silk Road with Yumen and Yangguan forts.',
        emperors_title: 'Emperors & Institutions',
        emperor_1_name: 'Emperor Gaozu (Liu Bang)', emperor_1_reign: 'Reign: 202-195 BCE', emperor_1_feat1: 'Founded Han Dynasty', emperor_1_feat2: 'Promoted laissez-faire policies', emperor_1_feat3: 'Established commandery system',
        emperor_2_name: 'Emperor Wu (Liu Che)', emperor_2_reign: 'Reign: 141-87 BCE', emperor_2_feat1: 'Promoted Confucianism exclusively', emperor_2_feat2: 'Expanded territories westward', emperor_2_feat3: 'Opened the Silk Road',
        emperor_3_name: 'Emperor Guangwu (Liu Xiu)', emperor_3_reign: 'Reign: 25-57 CE', emperor_3_feat1: 'Restored Han Dynasty', emperor_3_feat2: 'Reduced taxes, reformed bureaucracy', emperor_3_feat3: 'Strengthened central authority',
        emperor_4_name: 'Emperor Xian (Liu Xie)', emperor_4_reign: 'Reign: 189-220 CE', emperor_4_feat1: 'Last Han emperor', emperor_4_feat2: 'Controlled by warlords', emperor_4_feat3: 'Forced to abdicate',
        gov_title: 'Thought & Culture',
        gov_box1_title: 'Exclusive Confucianism', gov_box1_desc: 'Emperor Wu established Confucianism as state orthodoxy, influencing China for 2000 years.',
        gov_box2_title: 'Imperial Academy', gov_box2_desc: 'Founded by Emperor Wu, it trained Confucian scholars and established state education.',
        gov_box3_title: 'Ritual Music System', gov_box3_desc: 'Han revived and perfected Zhou ritual system centered on Confucian ceremonies.',
        gov_chart_caption: 'Chart shows influence of thought schools, Confucianism (green) dominated after Emperor Wu.',
        culture_title: 'International Exchange',
        culture_intro: 'Han was China\'s first era of large-scale foreign exchange through the Silk Road, connecting with Central Asia, South Asia and Rome.',
        culture_card1_title: 'Zhang Qian to West', culture_card1_desc: 'Zhang Qian\'s missions opened the Silk Road, promoting cultural exchange.',
        culture_card1_quote: '"He pierced the void to the Western Regions, opened the Silk Road, achieving eternal merit." <br>— Sima Qian',
        culture_card2_title: 'Cultural Exchange', culture_card2_desc: 'Silk Road facilitated Buddhism\'s arrival in China and spread Chinese inventions westward.',
        exchange_title: 'Inventions & Technology',
        exchange_intro: 'Han was crucial for Chinese technological development with breakthroughs in papermaking, astronomy and medicine.',
        exchange_box1_title: 'Cai Lun Paper', exchange_box1_desc: 'Cai Lun improved papermaking using bark and rags, revolutionizing communication.',
        exchange_box2_title: 'Zhang Heng Seismoscope', exchange_box2_desc: 'Zhang Heng invented the world\'s first seismoscope, showcasing Han astronomy.',
        exchange_img_caption: 'Replica of Zhang Heng\'s seismoscope, demonstrating Han technology.',
        scholars_title: 'Decline & Historical Impact',
        scholars_intro: 'Late Han corruption, power struggles, land concentration and natural disasters led to the Yellow Turban Rebellion and collapse.',
        scholar_1_name: 'Yellow Turban', scholar_1_desc: 'Rebellion weakened central authority and led to warlordism.',
        scholar_2_name: 'Power Struggles', scholar_2_desc: 'Eunuchs and relatives fought for power, increasing corruption.',
        scholar_3_name: 'Warlord Era', scholar_3_desc: 'After rebellion, warlords controlled regions, leading to collapse.',
        scholar_4_name: 'Dynasty Ends', scholar_4_desc: 'Emperor Xian abdicated in 220 CE, beginning Three Kingdoms period.',
        decline_title: 'Han Legacy',
        decline_chart_caption: 'Chart shows Han cultural influence (green) over time with enduring impact.',
        decline_box1_title: 'Cultural Identity', decline_box1_desc: 'Han established "Han people", "Han language", "Han characters" as core cultural concepts.',
        decline_box2_title: 'Institutional Legacy', decline_box2_desc: 'Han created centralized bureaucracy and county system used by later dynasties.',
        decline_box3_title: 'Hanfu Revival', decline_box3_desc: 'Contemporary Hanfu movement revives Han clothing as cultural renaissance symbol.',
        legacy_title: 'Historical Legacy',
        legacy_intro: 'Though fallen for nearly 2000 years, Han civilization profoundly influenced China and East Asia, making Han culture its core.',
        legacy_box1_title: 'Ideological Legacy', legacy_box1_desc: 'Han established Confucian orthodoxy influencing China for two millennia.',
        legacy_box2_title: 'Cultural Legacy', legacy_box2_desc: 'Han fu poetry, clerical script and stone carvings became foundations of Chinese art.',
        legacy_quote: '"Han was China\'s first long-term stable unified empire, whose political system, cultural achievements and territorial scale laid China\'s basic pattern."',
        legacy_quote_author: '— Qian Mu, Chinese Historian',
        han_video_title: 'Han Dynasty Style Beauty Video',
        han_video_desc: "<strong>The Splendor of Han: Attire & Cosmetics</strong><br><br>The attire of Han Dynasty women is celebrated for its elegance and grandeur, fully embodying the confidence and cultural depth of a unified empire. The early period favored the 'Quju' (curved-hem robe) which wrapped around the body, while the later period featured the simpler 'Zhiju' (straight-hem robe). Wide sleeves, layered garments, and exquisite embroidery collectively formed the unique charm of Hanfu.<br><br>Hairstyles and makeup were equally sophisticated. Women often wore high, elaborate buns, adorned with ornate hairpins and 'buyao' (swaying hair ornaments). For makeup, a fair complexion was prized, achieved with white powder. This was accented with vermilion rouge on the lips and cheeks. Eyebrows were drawn long and curved. The overall look was one of dignified grace and charm, reflecting the unique aesthetic and spirit of Han Dynasty women.",
        chart_timeline_labels: ['Gaozu', 'Wu', 'Guangwu', 'Xian', 'Late Han'],
        chart_gov_title: 'Han Thought Influence',
        chart_gov_label_central: 'Confucianism', chart_gov_label_provincial: 'Other Schools', chart_gov_yaxis: 'Influence Index',
        chart_rel_title: 'Han Foreign Exchange',
        chart_rel_label: 'Exchange Intensity', chart_rel_cats: ['Xiongnu', 'West Regions', 'Korea', 'Nanyue', 'India', 'Rome'],
        chart_dec_title: 'Han Cultural Influence',
        chart_dec_label_central: 'Han Influence', chart_dec_label_regional: 'Other Influences', chart_dec_yaxis: 'Influence Index',
      }
    };

    // --- 核心腳本 ---
    document.addEventListener('DOMContentLoaded', function() {
        
        const AUTOPLAY_INTERVAL = 8000;

        let currentLang = 'zh-TW';
        let isAutoplaying = false;
        let autoplayTimeoutId;
        let currentSectionIndex = 0;
        let currentlySpeakingSection = null;
        let isManuallyStopped = false; 
        
        let activeLockSection = null;

        const sections = Array.from(document.querySelectorAll('main > section'));
        const langToggleBtn = document.getElementById('lang-toggle');
        const autoplayToggleBtn = document.getElementById('autoplay-toggle');
        const fullscreenToggleBtn = document.getElementById('fullscreen-toggle');
        const musicToggleBtn = document.getElementById('music-toggle');
        const toTopBtn = document.getElementById('to-top-btn');
        const bgMusic = document.getElementById('bg-music');
        const navbar = document.querySelector('.navbar');
        
        const wheelLockHandler = (event) => {
            if (!activeLockSection) return;
            const rect = activeLockSection.getBoundingClientRect();
            const isAtTop = rect.top >= 0;
            const isAtBottom = rect.bottom <= window.innerHeight;

            if (event.deltaY < 0 && isAtTop) { event.preventDefault(); }
            if (event.deltaY > 0 && isAtBottom) { event.preventDefault(); }
        };
        const touchLockHandler = (event) => {
             if (activeLockSection) { event.preventDefault(); }
        };
        function lockScreenToSection(section) {
            document.body.classList.add('tts-active');
            activeLockSection = section;
            window.addEventListener('wheel', wheelLockHandler, { passive: false });
            window.addEventListener('touchmove', touchLockHandler, { passive: false });
        }
        function unlockScreen() {
            document.body.classList.remove('tts-active');
            activeLockSection = null;
            window.removeEventListener('wheel', wheelLockHandler);
            window.removeEventListener('touchmove', touchLockHandler);
        }
        function setTtsButtonState(button, isPlaying) {
            const playKey = 'tts_play_btn';
            const stopKey = 'tts_stop_btn';
            if (isPlaying) {
                button.innerHTML = translations[currentLang][stopKey] || '⏹️ Stop Reading';
                button.classList.add('is-playing');
            } else {
                button.innerHTML = translations[currentLang][playKey] || '🔊 Read Aloud';
                button.classList.remove('is-playing');
            }
        }
        function resetAllTtsButtons() {
            document.querySelectorAll('.tts-btn').forEach(btn => {
                setTtsButtonState(btn, false);
            });
        }
        function updateLanguage() {
            document.documentElement.lang = currentLang;
            document.querySelectorAll('[data-lang-key]').forEach(el => {
                const key = el.dataset.langKey;
                if (translations[currentLang][key]) {
                    if (el.classList.contains('tts-btn') && el.classList.contains('is-playing')) {
                         el.innerHTML = translations[currentLang]['tts_stop_btn'];
                    } else {
                         el.innerHTML = translations[currentLang][key];
                    }
                }
            });
            initializeAllCharts(currentLang);
        }
        langToggleBtn.addEventListener('click', () => {
            currentLang = currentLang === 'zh-TW' ? 'en' : 'zh-TW';
            updateLanguage();
        });
        function getCleanTextForTTS(section) {
            const contentContainer = section.querySelector('.content-container');
            if (!contentContainer) return "";
            const clone = contentContainer.cloneNode(true);
            clone.querySelectorAll('.tts-btn, .section-title, .image-container-styled, canvas, .scholar-img, iframe').forEach(el => el.remove());
            const title = section.querySelector('.section-title')?.innerText || '';
            const body = clone.innerText.trim();
            return `${title}. ${body}`;
        }
        function stopAutoscroll() {
            isAutoplaying = false;
            document.body.classList.remove('autoplay-active'); 
            autoplayToggleBtn.innerHTML = '<i class="fas fa-play"></i>';
            clearTimeout(autoplayTimeoutId);
        }
        function stopSpeech() {
            if (!speechSynthesis.speaking) return;
            isManuallyStopped = true; 
            speechSynthesis.cancel(); 
        }
        function speakSection(section, onEndCallback) {
            const textToSpeak = getCleanTextForTTS(section);
            if (!textToSpeak) {
                if (onEndCallback) onEndCallback();
                return;
            }
            
            const utterance = new SpeechSynthesisUtterance(textToSpeak);
            utterance.lang = currentLang === 'en' ? 'en-US' : 'zh-TW';
            
            const ttsBtn = section.querySelector('.tts-btn');

            utterance.onstart = () => {
                currentlySpeakingSection = section;
                if (ttsBtn) setTtsButtonState(ttsBtn, true);
                lockScreenToSection(section);
            };
            
            utterance.onend = () => {
                const wasManuallyStopped = isManuallyStopped;
                if (currentlySpeakingSection === section) {
                    if (ttsBtn) setTtsButtonState(ttsBtn, false);
                    currentlySpeakingSection = null;
                }
                unlockScreen();
                if (onEndCallback && !wasManuallyStopped) {
                    onEndCallback();
                }
            };

            utterance.onerror = (e) => {
                console.error("Speech synthesis error:", e);
                if (currentlySpeakingSection === section) {
                    if (ttsBtn) setTtsButtonState(ttsBtn, false);
                    currentlySpeakingSection = null;
                }
                unlockScreen();
                if (onEndCallback) onEndCallback();
            };
            
            isManuallyStopped = false; 
            speechSynthesis.speak(utterance);
        }

        function playAndAdvance() {
            if (!isAutoplaying) return;

            clearTimeout(autoplayTimeoutId);

            const lastPlayableIndex = sections.length - 2; // The video section is last, so index is length - 1. We stop at the one before it.
            const section = sections[currentSectionIndex];
            
            if (!section || currentSectionIndex > lastPlayableIndex) {
                currentSectionIndex = 0; // Loop back if index is out of bounds
                playAndAdvance();
                return;
            }

            section.scrollIntoView({ behavior: 'smooth', block: 'start' });

            const advanceNext = () => {
                if (isAutoplaying) {
                    if (currentSectionIndex >= lastPlayableIndex) {
                        currentSectionIndex = 0; // Loop back to the start from the last playable section
                    } else {
                        currentSectionIndex++;
                    }
                    playAndAdvance();
                }
            };
            
            autoplayTimeoutId = setTimeout(advanceNext, AUTOPLAY_INTERVAL);
        }

        function startAutoscroll() {
            if (isAutoplaying) return;
            
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
            }

            isAutoplaying = true;
            document.body.classList.add('autoplay-active'); 
            autoplayToggleBtn.innerHTML = '<i class="fas fa-pause"></i>';
            
            let mostVisibleSectionIndex = 0;
            let maxVisibility = 0;
            
            sections.forEach((section, index) => {
                const rect = section.getBoundingClientRect();
                const vh = window.innerHeight || document.documentElement.clientHeight;
                const visibleHeight = Math.max(0, Math.min(rect.bottom, vh) - Math.max(rect.top, 0));
                if (visibleHeight > maxVisibility) {
                    maxVisibility = visibleHeight;
                    mostVisibleSectionIndex = index;
                }
            });

            currentSectionIndex = mostVisibleSectionIndex;
            // If autoplay is started from the video section, restart from the beginning.
            if (sections[currentSectionIndex] && sections[currentSectionIndex].id === 'han-beauty-video') {
                currentSectionIndex = 0;
            }
            
            playAndAdvance();
        }

        autoplayToggleBtn.addEventListener('click', () => {
            if (isAutoplaying) {
                stopAutoscroll();
            } else {
                startAutoscroll();
            }
        });

        function updateFullscreenIcon() {
            if (!document.fullscreenElement) {
                fullscreenToggleBtn.innerHTML = '<i class="fas fa-expand"></i>';
            } else {
                fullscreenToggleBtn.innerHTML = '<i class="fas fa-compress"></i>';
            }
        }
        fullscreenToggleBtn.addEventListener('click', () => {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    alert(`無法進入全螢幕模式: ${err.message} (${err.name})`);
                });
            } else {
                if (document.exitFullscreen) document.exitFullscreen();
            }
        });
        document.addEventListener('fullscreenchange', updateFullscreenIcon);
        musicToggleBtn.addEventListener('click', () => {
            if (bgMusic.paused) {
                bgMusic.play().catch(e => console.log("音樂自動播放被瀏覽器阻止。"));
                musicToggleBtn.innerHTML = '<i class="fas fa-music"></i>';
            } else {
                bgMusic.pause();
                musicToggleBtn.innerHTML = '<i class="fas fa-volume-mute"></i>';
            }
        });
        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) entry.target.classList.add('visible');
          });
        }, { threshold: 0.15 });
        document.querySelectorAll('.scroll-reveal').forEach(el => observer.observe(el));
        function getCurrentSectionId() {
            let current = '';
            for (const section of sections) {
                const sectionTop = section.offsetTop;
                if (window.scrollY >= sectionTop - 200) current = section.getAttribute('id');
            }
            return current;
        }
        window.addEventListener('scroll', () => {
            if(document.body.classList.contains('tts-active')) return;

            if (window.pageYOffset > 300) { toTopBtn.style.display = 'flex'; } 
            else { toTopBtn.style.display = 'none'; }
            if (window.scrollY > 50) { navbar.classList.add('scrolled'); } 
            else { navbar.classList.remove('scrolled'); }
            
            const current = getCurrentSectionId();
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href').includes(current)) link.classList.add('active');
            });
        });
        toTopBtn.addEventListener('click', () => {
            stopAutoplay();
            stopSpeech();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
        document.querySelectorAll('.nav-links a').forEach(link => {
            link.addEventListener('click', () => {
                stopAutoplay();
                stopSpeech();
            });
        });
        document.querySelectorAll('.hotspot').forEach(hotspot => {
          hotspot.addEventListener('click', (e) => {
            e.stopPropagation();
            const targetId = hotspot.dataset.target;
            const infoBox = document.getElementById(targetId);
            const isVisible = infoBox.style.display === 'block';
            document.querySelectorAll('.info-box').forEach(box => box.style.display = 'none');
            if (infoBox && !isVisible) infoBox.style.display = 'block';
          });
        });
        document.addEventListener('click', () => {
             document.querySelectorAll('.info-box').forEach(box => box.style.display = 'none');
        });
        document.querySelectorAll('.tts-btn').forEach(button => {
            button.addEventListener('click', () => {
                if (isAutoplaying) return;
                const section = button.closest('.slide-section');
                if (!section) return;
                const wasSpeakingThisSection = (currentlySpeakingSection === section && speechSynthesis.speaking);
                stopSpeech();
                if (!wasSpeakingThisSection) {
                    speakSection(section, null); 
                }
            });
        });

        let charts = {};
        function initializeAllCharts(lang) {
            const langData = translations[lang];
            const titleFont = { family: "'Noto Serif TC', serif", size: 20, weight: 'bold' };
            const bodyFont = { family: "'Noto Serif TC', serif", size: 16 };
            const primaryColor = '#42675A';
            const accentColor = '#893F27';
            const darkText = '#3D3D3D';

            Object.keys(charts).forEach(id => {
                if(charts[id]) charts[id].destroy();
            });

            Chart.defaults.color = darkText; 
            Chart.defaults.font.family = "'Noto Serif TC', serif";

            if (document.getElementById('timelineChart')) {
              const ctx = document.getElementById('timelineChart').getContext('2d');
              charts.timeline = new Chart(ctx, {
                type: 'bar',
                data: {
                  labels: langData.chart_timeline_labels,
                  datasets: [{
                    data: [15, 28, 20, 10, 22, 18, 12, 5], 
                    backgroundColor: ['#42675A', '#5A877A', '#42675A', '#6E2D1C', '#5A877A', '#42675A', '#6E2D1C', '#893F27'],
                    borderColor: accentColor, borderWidth: 1,
                    barPercentage: 1, categoryPercentage: 1
                  }]
                },
                options: { 
                  indexAxis: 'y', responsive: true, maintainAspectRatio: false, 
                  plugins: { legend: { display: false } }, 
                  scales: { x: { ticks: { display: false }, grid: { display: false } }, y: { ticks: { font: bodyFont, color: darkText }, grid: { display: false } } } 
                }
              });
            }

            if (document.getElementById('governmentChart')) {
              const ctx = document.getElementById('governmentChart').getContext('2d');
              charts.government = new Chart(ctx, {
                type: 'bar',
                data: {
                  labels: lang === 'zh-TW' ? ['漢初', '漢武帝時期', '東漢'] : ['Early Han', 'Emperor Wu', 'Eastern Han'],
                  datasets: [
                    { label: langData.chart_gov_label_central, data: [40, 85, 75], backgroundColor: 'rgba(66, 103, 90, 0.7)', borderColor: primaryColor, borderWidth: 2 }, 
                    { label: langData.chart_gov_label_provincial, data: [60, 15, 25], backgroundColor: 'rgba(137, 63, 39, 0.7)', borderColor: accentColor, borderWidth: 2 }
                  ]
                },
                options: { 
                  responsive: true, maintainAspectRatio: false, 
                  plugins: { title: { display: true, text: langData.chart_gov_title, font: titleFont, color: primaryColor }, legend: { position: 'bottom', labels: { font: bodyFont } } }, 
                  scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: langData.chart_gov_yaxis, font: bodyFont } } } 
                }
              });
            }
            
            if (document.getElementById('relationChart')) {
              const ctx = document.getElementById('relationChart').getContext('2d');
              charts.relation = new Chart(ctx, {
                type: 'radar',
                data: {
                  labels: langData.chart_rel_cats,
                  datasets: [{
                    label: langData.chart_rel_label, data: [90, 85, 75, 70, 60, 40],
                    backgroundColor: 'rgba(66, 103, 90, 0.3)', borderColor: primaryColor, borderWidth: 2, 
                    pointBackgroundColor: accentColor, pointBorderColor: '#fff', 
                    pointHoverBackgroundColor: '#fff', pointHoverBorderColor: primaryColor
                  }]
                },
                options: { 
                  responsive: true, maintainAspectRatio: false, 
                  plugins: { title: { display: true, text: langData.chart_rel_title, font: titleFont, color: primaryColor }, legend: { display: false } }, 
                  scales: { r: { pointLabels: { font: { ...bodyFont, weight: 'bold' }, color: darkText }, grid: { color: 'rgba(0,0,0,0.1)' }, angleLines: { color: 'rgba(0,0,0,0.1)' } } } 
                }
              });
            }

            if (document.getElementById('declineChart')) {
              const ctx = document.getElementById('declineChart').getContext('2d');
              charts.decline = new Chart(ctx, {
                type: 'line',
                data: {
                  labels: lang === 'zh-TW' ? ['漢朝', '三國', '隋唐', '宋', '元', '明', '清', '現代'] : ['Han', '3K', 'Sui-Tang', 'Song', 'Yuan', 'Ming', 'Qing', 'Modern'],
                  datasets: [
                    { label: langData.chart_dec_label_central, data: [100, 85, 90, 75, 70, 80, 85, 95], borderColor: primaryColor, backgroundColor: 'rgba(66, 103, 90, 0.2)', tension: 0.1, fill: true },
                    { label: langData.chart_dec_label_regional, data: [20, 40, 30, 45, 60, 50, 55, 40], borderColor: accentColor, backgroundColor: 'rgba(137, 63, 39, 0.2)', tension: 0.1, fill: true }
                  ]
                },
                options: { 
                  responsive: true, maintainAspectRatio: false, 
                  plugins: { title: { display: true, text: langData.chart_dec_title, font: titleFont, color: primaryColor }, legend: { position: 'bottom', labels: { font: bodyFont } } }, 
                  scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: langData.chart_dec_yaxis, font: bodyFont } } } 
                }
              });
            }
        }

        updateLanguage();
        
        document.addEventListener('click', function initMusic() {
          if(bgMusic.paused){
            bgMusic.play().catch(e => console.log("音樂自動播放被瀏覽器阻止。"));
            musicToggleBtn.innerHTML = '<i class="fas fa-music"></i>';
          }
          document.removeEventListener('click', initMusic);
        });
    });
    </script>
</body>
</html>